# Задание 1

Вам нужно разделить проект Mesto на несколько микрофронтендов.
Самостоятельно решите, какой фреймворк будете использовать, — Module Federation или Single SPA.

## Анализ текущего решения
Функциональность приложения можно разделить на 3 области

### Авторизация
Пользователю предоставляет возможность зарегистрироваться, авторизироваться и выйти.

При регистрации открывается форма с 2мя полями - email и пароль (React компонент `Register`)
При авторизации открывается аналогичная (технически - та же самая `src/blocks/auth-form`) форма с полями для ввода email и пароля (React компонент `Login`)
После входа пользователю доступна возможность выхода из приложения (собственного компонента не имеет).
Кроме того используется React компонент `InfoTooltip` - он показывается в случае ошибок валидации при регистрации/авторизации.

### Профиль
Профиль содержит в себе фото пользователя (аватар) и информацию об имени и роде занятий.
Пользователь имеет возможность поменять аватара через всплывающее окно (React компонент `EditAvatarPopup`, использующий другоЙ компонент `PopupWithForm`).
Кроме того, пользователь имеет возможность просмотреть и при необходимости изменить информацию об имени и роде занятий (React компонент `EditProfilePopup`).

### Карточки мест

Карточка места содержит в себе название места, его изображение и счётчик лайков.
Пользователь имеет следующие возможности:
1. Просмотр всех карточек мест (React компонент `Main`).
После входа пользователя на его главной странице показываются все карточки со всеми данными - название, изображение и счётчик лайков.
2. Создание новой карточки места
При нажатии на кнопку "+" пользователь получает возможность добавить новую карточку места (используется React компонент `AddPlacePopup`, использующий другоЙ компонент `PopupWithForm`). 
Для добавления нужно заполнить название и указать ссылку на картинку.
При указании невалдиного URL картинки карточку сохранить не удаётся.
Возможно указать уже существующее название места - будет создана новая карточка (а не заменена старая).
Счётчик лайков для новой карточки устанавливается в 0.
3. Удаление карточки
Некоторые карточки снабжены иконкой корзины, нажатие на которую позволяет удалить карточку.
Принцип выбора карточек, доступных для удаления, я так и не понял. Точно можно удалить свои собственные карточки и некоторые уже добавленные до пользователя.
4. Просмотр увеличенного изображения с карточки.
При нажатии на изображение карточки открывается попап (React компонент `ImagePopup`) с увеличенным изображением места.
5. Лайки
На карточке имеет информация о количестве лайков.
Пользователь может поставить лайк или уже снять поставленный им же лайк (количество лайков обновляется динамически). 

Функциональность редактирования карточки отсутствует.

## Проектирование

В качестве стратегии проектирования логичнее всего выбрать <ins>**вертикальную нарезку**</ins>.
В анализе приложения мы как раз и выделили предметные области, на основе которых и можно "нарезать" микрофронтэнды.

Ниже цитата из урока о стратегии вертикальная нарезка
> Стратегия основана на предметно-ориентированном проектировании (Domain-Driven Design, DDD). Этот подход предполагает, что приложение делят на домены (domain) — это предметные области, которые описывают разные цели бизнеса.

Кроме того, такой подход позволит разрабатывать, тестировать и разворачивать микрофронтэнда независимо друг от друга.

---
В качестве варианта реализации логичнее всего выбрать <ins>**Run time**</ins> - объединения во время выполнения.
Build time плохо подходит, т.к. накладывает много ограничений - в частности, делает сложным использование разных технологий, а вертикальная нарезка предполагает наличие кросс-функциональных команд, которые могут сами выбирать наиболее подходящий стек технологий для реализации.
Кроме того build time преполагает что при изменении одного микрофронтэнда бандл будет пересобран целиком. Это уменьшает гибкость развёртывания - хотелось бы чтобы микрофронтэнды можно было деплоить и масштабировать независимо.

---
В качестве метода композиции логичнее всего было бы выбрать <ins>**паттерн BFF (Backend For Frontend)**</ins>.
Этот подход позволит получить преимущества как серверной, так и клиентской композиции (например, `lazy` загрузки компонент React).
К недостаткам метода можно отнести сложность реализации, требуется опытная команда.

---
В качестве фреймворка для реализации я бы выбрал <ins>**Single SPA**</ins>.
Как мне кажется, Single SPA более сфокусирован на том, чтобы дать возможность использовать разные фреймворки для разных микрофронтэндов в одном приложении. Т.к. предполагается, что каждый микрофронтэнд будет развивать отдельная команда, то хотелось бы дать ей возможность в выборе наиболее подхдящих инструментов.
Кроме того, хороших подспорьем будет ленивая загрузка кода и независимые разработка и развёртывание каждого микрофронтэнда.
С другой стороны Module Federation вроде как тоже позволяет использовать разные фреймворки в разных микрофронтэндах, так что вопрос выбора довольно холиварный и требует хороших знаний каждого фреймворка и его нюансов.

Как вариант, сделать выбор по "звёздочкам" GitHub (при прочих равных) :)

| Фреймворк    | Stars |
| -------- | ------- |
| [Module Federation](https://github.com/module-federation/core) | ⭐1.5k |
| [Single SPA](https://github.com/single-spa/single-spa) | ⭐13.3k |

## Описание микрофронтэндов

Предлагается сделать 3 отдельных микрофронтэнда (по числу доменных областей) + host приложение. Ниже приведена предлагаемая структура проекта.

```
microfrontend/
├── auth-microfrontend
│   ├── index.js
│   └── src
│       ├── blocks
│       │   ├── auth-form
│       │   │   ├── __button
│       │   │   ├── __form
│       │   │   ├── __input
│       │   │   ├── __link
│       │   │   ├── __text
│       │   │   ├── __textfield
│       │   │   ├── __title
│       │   │   └── auth-form.css
│       │   └── login
│       │       └── login.css
│       └── components
│           ├── Login.js
│           └── Register.js
├── host
│   ├── index.js
│   └── src
│       ├── blocks
│       │   ├── content
│       │   │   └── content.css
│       │   ├── footer
│       │   │   ├── __copyright
│       │   │   └── footer.css
│       │   ├── header
│       │   │   ├── __auth-link
│       │   │   ├── __logo
│       │   │   ├── __logout
│       │   │   ├── __user
│       │   │   ├── __wrapper
│       │   │   └── header.css
│       │   ├── page
│       │   │   ├── __content
│       │   │   ├── __section
│       │   │   └── page.css
│       │   └── popup
│       │       ├── __button
│       │       ├── __caption
│       │       ├── __close
│       │       ├── __content
│       │       ├── __error
│       │       ├── __form
│       │       ├── __icon
│       │       ├── __image
│       │       ├── __input
│       │       ├── __label
│       │       ├── __status-message
│       │       ├── __title
│       │       ├── _is-opened
│       │       ├── _type
│       │       └── popup.css
│       ├── components
│       │   ├── App.js
│       │   ├── Footer.js
│       │   ├── Header.js
│       │   ├── InfoTooltip.js
│       │   ├── Main.js
│       │   ├── PopupWithForm.js
│       │   └── ProtectedRoute.js
│       └── images
│           ├── close.svg
│           ├── error-icon.svg
│           ├── logo.svg
│           └── success-icon.svg
├── places-microfrontend
│   ├── index.js
│   └── src
│       ├── blocks
│       │   ├── card
│       │   │   ├── __delete-button
│       │   │   ├── __description
│       │   │   ├── __image
│       │   │   ├── __like-button
│       │   │   ├── __like-count
│       │   │   ├── __title
│       │   │   └── card.css
│       │   └── places
│       │       ├── __item
│       │       ├── __list
│       │       └── places.css
│       ├── components
│       │   ├── AddPlacePopup.js
│       │   ├── Card.js
│       │   └── ImagePopup.js
│       └── images
│           ├── delete-icon.svg
│           ├── like-active.svg
│           └── like-inactive.svg
└── profiles-microfrontend
    ├── index.js
    └── src
        ├── blocks
        │   └── profile
        │       ├── __add-button
        │       ├── __description
        │       ├── __edit-button
        │       ├── __image
        │       ├── __info
        │       ├── __title
        │       └── profile.css
        ├── components
        │   ├── EditAvatarPopup.js
        │   └── EditProfilePopup.js
        └── images
            ├── add-icon.svg
            └── edit-icon.svg
```

Стоит добавить к схеме выше - там нет JS модулей `api.js` и `auth.js`.
Их функциональность тоже стоит разделить по микрофронтэндам.
Например, `class Api` (`api.js`) нужно распилить на несколько частей, т.к. в нём присутствует функционал, необходимый нескольким фронтэндам.
В `profiles-microfrontend` должны быть перенесены методы `getUserInfo`, `setUserInfo` и `setUserAvatar`
В `places-microfrontend` должны быть перенесены методы `getCardList`, `addCard`, `removeCard` и `changeLikeCardStatus`.
Однако следует заметить, что есть ещё метод `getAppInfo`, который используется основным приложением `host`, и будет в случае деления использовать методы из разных фронтэндов - возможно, это решается выделением в какую-то общую библиотеку.

```
  getAppInfo() {
    return Promise.all([this.getCardList(), this.getUserInfo()]);
  }
```

`auth.js` можно было бы целиком перенести в `auth-microfrontend`, но основное приложение `host` использует метод `checkToken`. Наверняка работу с токеном тоже как-то можно "размазать", но как - мне неведомо. 

Кроме того, было бы целесообразно выделить в отдельную библиотеку React компонент `PopupWithForm` - чтобы избежать его дублирования в микрофронтэндах.

Порядок вынесения микрофронтэндов я бы предложил следующий
1. Авторизация (`auth-microfrontend`)
На нём можно "обкатать" микрофронтэнды (если у команды не было опыта) - его функциональность проста (относительно других микрофронтэндов) и легко тестируема (пользователь авторизовался/нет, смог зарегистрировать/нет)
2. Профили (`profiles-microfrontend`)
3. Карточки мест (`places-microfrontend`)

# Задание 2

В этом задании вам нужно декомпозировать веб-приложения на Django на микросервисы.

Кодить не придётся: в этот раз вы будете работать в онлайн-редакторе draw.io.

[Оригинальная архитектура](https://viewer.diagrams.net/?tags=%7B%7D&lightbox=1&highlight=0000ff&edit=_blank&layers=1&nav=1&title=arch_template_task2.drawio#Uhttps%3A%2F%2Fdrive.google.com%2Fuc%3Fid%3D15uv9e9iZqym5hA64fePVMoOilOCTT9ho%26export%3Ddownload) ([исходник](./arch_template_task2.drawio))

[Микросервисная архитектура](https://viewer.diagrams.net/?tags=%7B%7D&lightbox=1&highlight=0000ff&edit=_blank&layers=1&nav=1&title=microservices.drawio#Uhttps%3A%2F%2Fdrive.google.com%2Fuc%3Fid%3D1vs5vrptio0XsAamCvdTlLGAhVQcXbcuT%26export%3Ddownload) ([исходник](./microservices.drawio))